<ContentHeader />

<div class="au-u-flex" style="height: 100%;">
  <SearchSidebar
    @municipalityPlaceholder="Selecteer een optie"
    @municipalityOnChange={{this.handleMunicipalityChange}}
    @municipalityOptions={{@model.municipalities}}
    @municipalityAllowClear={{true}}
    @keywordPlaceholder={{"Terrasvergunning"}}
    @keywordOnChange={{this.handleKeywordChange}}
    @applyDatePicker={{this.applyDatePicker}}
    @cancelDatePicker={{this.cancelDatePicker}}
    @hideDatePicker={{this.hideDatePicker}}
    @valueMunicipality={{this.selectedMunicipality}}
    @valueKeyword={{this.keyword}}
    @valueStartDate={{this.plannedStartMin}}
    @valueEndDate={{this.plannedStartMax}}
  />

  <section
    class="au-u-flex au-u-flex--column"
    style="width: 100%; height: 100%;"
  >
    <AuFormRow
      @alignment="inline"
      class="au-u-margin-bottom au-u-margin-top au-u-padding-right-large au-u-padding-left-large"
    >
      <section style="margin-left: auto;" class="au-u-flex">
        <AuLabel for="sort-on" style="width: 80px; white-space: nowrap;">
          Sorteer op
        </AuLabel>
        <select
          type="select"
          onchange={{action "handleSort"}}
          class="au-c-input"
          style="width: 200px;"
        >
          <option>Relevantie</option>
          <option>Datum</option>
        </select>
      </section>
    </AuFormRow>
    <div
      class="au-u-flex au-u-flex--column"
      style="height: 75%; scroll-behavior: smooth;"
    >
      {{#if this.errorMsg}}
        <AuContent
          style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; gap: 8rem;"
        >
          <section>
            <h3>Oeps!</h3>
            <p style="margin: 2rem 0;">Er is iets fout gelopen!</p>
            <AuLink @skin="button" @route="home">Terug naar de startpagina</AuLink>
          </section>
        </AuContent>
      {{else}}
        {{#if this.loading}}
          <main
            style="justify-content: center; align-items: center; display: flex; flex-direction: column; height: 100%;"
          >
            <AuLoader />
            <AuContent>
              <h3>Agendapunt aan het laden</h3>
            </AuContent>
          </main>

        {{else}}
          {{! if @model.agendaItems length is equal to 0 }}
          {{#if (eq @model.agendaItems.length 0)}}
            <AuAlert
              class="au-u-medium au-u-margin"
              style=" position: sticky; top: 0;"
              @skin="warning"
              @icon="three-dots"
            >
              Deze gemeente heeft nog geen agendapunten.
            </AuAlert>
          {{else}}
            <InfiniteList
              @loadMore={{action "loadMore"}}
              @isLoading={{this.isLoadingMore}}
            >
              {{#each @model.agendaItems as |item|}}
                <DecisionCard
                  @startDate={{item.session.startedAt}}
                  @endDate={{item.session.endedAt}}
                  @item={{item}}
                />
              {{/each}}
            </InfiniteList>
          {{/if}}
        {{/if}}
      {{/if}}

    </div>
  </section>
</div>
